{"version":3,"file":"index.js","mappings":"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","sources":["webpack://supersetEmbeddedSdk/webpack/universalModuleDefinition","webpack://supersetEmbeddedSdk/./node_modules/@superset-ui/switchboard/esm/switchboard.js","webpack://supersetEmbeddedSdk/webpack/bootstrap","webpack://supersetEmbeddedSdk/webpack/runtime/define property getters","webpack://supersetEmbeddedSdk/webpack/runtime/harmony module decorator","webpack://supersetEmbeddedSdk/webpack/runtime/hasOwnProperty shorthand","webpack://supersetEmbeddedSdk/webpack/runtime/make namespace object","webpack://supersetEmbeddedSdk/./src/const.ts","webpack://supersetEmbeddedSdk/./node_modules/decode-uri-component/index.js","webpack://supersetEmbeddedSdk/./node_modules/split-on-first/index.js","webpack://supersetEmbeddedSdk/./node_modules/filter-obj/index.js","webpack://supersetEmbeddedSdk/./node_modules/query-string/base.js","webpack://supersetEmbeddedSdk/./node_modules/query-string/index.js","webpack://supersetEmbeddedSdk/./node_modules/jwt-decode/build/jwt-decode.esm.js","webpack://supersetEmbeddedSdk/./src/guestTokenRefresh.ts","webpack://supersetEmbeddedSdk/./src/index.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"supersetEmbeddedSdk\"] = factory();\n\telse\n\t\troot[\"supersetEmbeddedSdk\"] = factory();\n})(globalThis, () => {\nreturn ","(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;};\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * A utility for communications between an iframe and its parent, used by the Superset embedded SDK.\n * This builds useful patterns on top of the basic functionality offered by MessageChannel.\n *\n * Both windows instantiate a Switchboard, passing in their MessagePorts.\n * Calling methods on the switchboard causes messages to be sent through the channel.\n */\nexport class Switchboard {\n\n\n\n\n\n\n  // used to make unique ids\n\n\n\n\n  constructor({ port, name = 'switchboard', debug = false }) {this.port = void 0;this.name = void 0;this.methods = {};this.incrementor = 1;this.debugMode = void 0;\n    this.port = port;\n    this.name = name;\n    this.debugMode = debug;\n\n    port.addEventListener('message', async (event) => {\n      this.log('message received', event);\n      const message = event.data;\n      if (isGet(message)) {\n        // find the method, call it, and reply with the result\n        this.port.postMessage(await this.getMethodResult(message));\n      } else if (isEmit(message)) {\n        const { method, args } = message;\n        // Find the method and call it, but no result necessary.\n        // Should this multicast to a set of listeners?\n        // Maybe, but that requires writing a bunch more code\n        // and I haven't found a need for it yet.\n        const executor = this.methods[method];\n        if (executor) {\n          executor(args);\n        }\n      }\n    });\n  }\n\n  async getMethodResult({\n    messageId,\n    method,\n    args })\n  {\n    const executor = this.methods[method];\n    if (executor == null) {\n      return {\n        switchboardAction: Actions.ERROR,\n        messageId,\n        error: `[${this.name}] Method \"${method}\" is not defined` };\n\n    }\n    try {\n      const result = await executor(args);\n      return {\n        switchboardAction: Actions.REPLY,\n        messageId,\n        result };\n\n    } catch (err) {\n      this.logError(err);\n      return {\n        switchboardAction: Actions.ERROR,\n        messageId,\n        error: `[${this.name}] Method \"${method}\" threw an error` };\n\n    }\n  }\n\n  /**\n   * Defines a method that can be \"called\" from the other side by sending an event.\n   */\n  defineMethod(methodName, executor) {\n    this.methods[methodName] = executor;\n  }\n\n  /**\n   * Calls a method registered on the other side, and returns the result.\n   *\n   * How this is accomplished:\n   * This switchboard sends a \"get\" message over the channel describing which method to call with which arguments.\n   * The other side's switchboard finds a method with that name, and calls it with the arguments.\n   * It then packages up the returned value into a \"reply\" message, sending it back to us across the channel.\n   * This switchboard has attached a listener on the channel, which will resolve with the result when a reply is detected.\n   *\n   * Instead of an arguments list, arguments are supplied as a map.\n   *\n   * @param method the name of the method to call\n   * @param args arguments that will be supplied. Must be serializable, no functions or other nonense.\n   * @returns whatever is returned from the method\n   */\n  get(method, args = undefined) {\n    return new Promise((resolve, reject) => {\n      // In order to \"call a method\" on the other side of the port,\n      // we will send a message with a unique id\n      const messageId = this.getNewMessageId();\n      // attach a new listener to our port, and remove it when we get a response\n      const listener = (event) => {\n        const message = event.data;\n        if (message.messageId !== messageId) return;\n        this.port.removeEventListener('message', listener);\n        if (isReply(message)) {\n          resolve(message.result);\n        } else {\n          const errStr = isError(message) ?\n          message.error :\n          'Unexpected response message';\n          reject(new Error(errStr));\n        }\n      };\n      this.port.addEventListener('message', listener);\n      this.port.start();\n      const message = {\n        switchboardAction: Actions.GET,\n        method,\n        messageId,\n        args };\n\n      this.port.postMessage(message);\n    });\n  }\n\n  /**\n   * Emit calls a method on the other side just like get does.\n   * But emit doesn't wait for a response, it just sends and forgets.\n   *\n   * @param method\n   * @param args\n   */\n  emit(method, args = undefined) {\n    const message = {\n      switchboardAction: Actions.EMIT,\n      method,\n      args };\n\n    this.port.postMessage(message);\n  }\n\n  start() {\n    this.port.start();\n  }\n\n  log(...args) {\n    if (this.debugMode) {\n      console.debug(`[${this.name}]`, ...args);\n    }\n  }\n\n  logError(...args) {\n    console.error(`[${this.name}]`, ...args);\n  }\n\n  getNewMessageId() {\n    // eslint-disable-next-line no-plusplus\n    return `m_${this.name}_${this.incrementor++}`;\n  } // @ts-ignore\n  __reactstandin__regenerateByEval(key, code) {// @ts-ignore\n    this[key] = eval(code);}}\n\n\n// Each message we send on the channel specifies an action we want the other side to cooperate with.\nvar Actions;\n\n\n\n\n\n\n// helper types/functions for making sure wires don't get crossed\n(function (Actions) {Actions[\"GET\"] = \"get\";Actions[\"REPLY\"] = \"reply\";Actions[\"EMIT\"] = \"emit\";Actions[\"ERROR\"] = \"error\";})(Actions || (Actions = {}));\n\n\n\n\n\n\n\n\n\n\n\nfunction isGet(message) {\n  return message.switchboardAction === Actions.GET;\n}\n\n\n\n\n\n\n\nfunction isReply(message) {\n  return message.switchboardAction === Actions.REPLY;\n}\n\n\n\n\n\n\n\nfunction isEmit(message) {\n  return message.switchboardAction === Actions.EMIT;\n}\n\n\n\n\n\n\n\nfunction isError(message) {\n  return message.switchboardAction === Actions.ERROR;\n};(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(Switchboard, \"Switchboard\", \"/Users/aaron/work/superset/superset-frontend/packages/superset-ui-switchboard/src/switchboard.ts\");reactHotLoader.register(isGet, \"isGet\", \"/Users/aaron/work/superset/superset-frontend/packages/superset-ui-switchboard/src/switchboard.ts\");reactHotLoader.register(isReply, \"isReply\", \"/Users/aaron/work/superset/superset-frontend/packages/superset-ui-switchboard/src/switchboard.ts\");reactHotLoader.register(isEmit, \"isEmit\", \"/Users/aaron/work/superset/superset-frontend/packages/superset-ui-switchboard/src/switchboard.ts\");reactHotLoader.register(isError, \"isError\", \"/Users/aaron/work/superset/superset-frontend/packages/superset-ui-switchboard/src/switchboard.ts\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.hmd = (module) => {\n\tmodule = Object.create(module);\n\tif (!module.children) module.children = [];\n\tObject.defineProperty(module, 'exports', {\n\t\tenumerable: true,\n\t\tset: () => {\n\t\t\tthrow new Error('ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: ' + module.id);\n\t\t}\n\t});\n\treturn module;\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nexport const IFRAME_COMMS_MESSAGE_TYPE = \"__embedded_comms__\";\nexport const DASHBOARD_UI_FILTER_CONFIG_URL_PARAM_KEY: { [index: string]: any } = {\n  visible: \"show_filters\",\n  expanded: \"expand_filters\",\n}\n\n","const token = '%[a-f0-9]{2}';\nconst singleMatcher = new RegExp('(' + token + ')|([^%]+?)', 'gi');\nconst multiMatcher = new RegExp('(' + token + ')+', 'gi');\n\nfunction decodeComponents(components, split) {\n\ttry {\n\t\t// Try to decode the entire string first\n\t\treturn [decodeURIComponent(components.join(''))];\n\t} catch {\n\t\t// Do nothing\n\t}\n\n\tif (components.length === 1) {\n\t\treturn components;\n\t}\n\n\tsplit = split || 1;\n\n\t// Split the array in 2 parts\n\tconst left = components.slice(0, split);\n\tconst right = components.slice(split);\n\n\treturn Array.prototype.concat.call([], decodeComponents(left), decodeComponents(right));\n}\n\nfunction decode(input) {\n\ttry {\n\t\treturn decodeURIComponent(input);\n\t} catch {\n\t\tlet tokens = input.match(singleMatcher) || [];\n\n\t\tfor (let i = 1; i < tokens.length; i++) {\n\t\t\tinput = decodeComponents(tokens, i).join('');\n\n\t\t\ttokens = input.match(singleMatcher) || [];\n\t\t}\n\n\t\treturn input;\n\t}\n}\n\nfunction customDecodeURIComponent(input) {\n\t// Keep track of all the replacements and prefill the map with the `BOM`\n\tconst replaceMap = {\n\t\t'%FE%FF': '\\uFFFD\\uFFFD',\n\t\t'%FF%FE': '\\uFFFD\\uFFFD',\n\t};\n\n\tlet match = multiMatcher.exec(input);\n\twhile (match) {\n\t\ttry {\n\t\t\t// Decode as big chunks as possible\n\t\t\treplaceMap[match[0]] = decodeURIComponent(match[0]);\n\t\t} catch {\n\t\t\tconst result = decode(match[0]);\n\n\t\t\tif (result !== match[0]) {\n\t\t\t\treplaceMap[match[0]] = result;\n\t\t\t}\n\t\t}\n\n\t\tmatch = multiMatcher.exec(input);\n\t}\n\n\t// Add `%C2` at the end of the map to make sure it does not replace the combinator before everything else\n\treplaceMap['%C2'] = '\\uFFFD';\n\n\tconst entries = Object.keys(replaceMap);\n\n\tfor (const key of entries) {\n\t\t// Replace all decoded components\n\t\tinput = input.replace(new RegExp(key, 'g'), replaceMap[key]);\n\t}\n\n\treturn input;\n}\n\nexport default function decodeUriComponent(encodedURI) {\n\tif (typeof encodedURI !== 'string') {\n\t\tthrow new TypeError('Expected `encodedURI` to be of type `string`, got `' + typeof encodedURI + '`');\n\t}\n\n\ttry {\n\t\t// Try the built in decoder first\n\t\treturn decodeURIComponent(encodedURI);\n\t} catch {\n\t\t// Fallback to a more advanced decoder\n\t\treturn customDecodeURIComponent(encodedURI);\n\t}\n}\n","export default function splitOnFirst(string, separator) {\n\tif (!(typeof string === 'string' && typeof separator === 'string')) {\n\t\tthrow new TypeError('Expected the arguments to be of type `string`');\n\t}\n\n\tif (string === '' || separator === '') {\n\t\treturn [];\n\t}\n\n\tconst separatorIndex = string.indexOf(separator);\n\n\tif (separatorIndex === -1) {\n\t\treturn [];\n\t}\n\n\treturn [\n\t\tstring.slice(0, separatorIndex),\n\t\tstring.slice(separatorIndex + separator.length)\n\t];\n}\n","export function includeKeys(object, predicate) {\n\tconst result = {};\n\n\tif (Array.isArray(predicate)) {\n\t\tfor (const key of predicate) {\n\t\t\tconst descriptor = Object.getOwnPropertyDescriptor(object, key);\n\t\t\tif (descriptor?.enumerable) {\n\t\t\t\tObject.defineProperty(result, key, descriptor);\n\t\t\t}\n\t\t}\n\t} else {\n\t\t// `Reflect.ownKeys()` is required to retrieve symbol properties\n\t\tfor (const key of Reflect.ownKeys(object)) {\n\t\t\tconst descriptor = Object.getOwnPropertyDescriptor(object, key);\n\t\t\tif (descriptor.enumerable) {\n\t\t\t\tconst value = object[key];\n\t\t\t\tif (predicate(key, value, object)) {\n\t\t\t\t\tObject.defineProperty(result, key, descriptor);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn result;\n}\n\nexport function excludeKeys(object, predicate) {\n\tif (Array.isArray(predicate)) {\n\t\tconst set = new Set(predicate);\n\t\treturn includeKeys(object, key => !set.has(key));\n\t}\n\n\treturn includeKeys(object, (key, value, object) => !predicate(key, value, object));\n}\n","import decodeComponent from 'decode-uri-component';\nimport splitOnFirst from 'split-on-first';\nimport {includeKeys} from 'filter-obj';\n\nconst isNullOrUndefined = value => value === null || value === undefined;\n\n// eslint-disable-next-line unicorn/prefer-code-point\nconst strictUriEncode = string => encodeURIComponent(string).replace(/[!'()*]/g, x => `%${x.charCodeAt(0).toString(16).toUpperCase()}`);\n\nconst encodeFragmentIdentifier = Symbol('encodeFragmentIdentifier');\n\nfunction encoderForArrayFormat(options) {\n\tswitch (options.arrayFormat) {\n\t\tcase 'index': {\n\t\t\treturn key => (result, value) => {\n\t\t\t\tconst index = result.length;\n\n\t\t\t\tif (\n\t\t\t\t\tvalue === undefined\n\t\t\t\t\t|| (options.skipNull && value === null)\n\t\t\t\t\t|| (options.skipEmptyString && value === '')\n\t\t\t\t) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\treturn [\n\t\t\t\t\t\t...result, [encode(key, options), '[', index, ']'].join(''),\n\t\t\t\t\t];\n\t\t\t\t}\n\n\t\t\t\treturn [\n\t\t\t\t\t...result,\n\t\t\t\t\t[encode(key, options), '[', encode(index, options), ']=', encode(value, options)].join(''),\n\t\t\t\t];\n\t\t\t};\n\t\t}\n\n\t\tcase 'bracket': {\n\t\t\treturn key => (result, value) => {\n\t\t\t\tif (\n\t\t\t\t\tvalue === undefined\n\t\t\t\t\t|| (options.skipNull && value === null)\n\t\t\t\t\t|| (options.skipEmptyString && value === '')\n\t\t\t\t) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\treturn [\n\t\t\t\t\t\t...result,\n\t\t\t\t\t\t[encode(key, options), '[]'].join(''),\n\t\t\t\t\t];\n\t\t\t\t}\n\n\t\t\t\treturn [\n\t\t\t\t\t...result,\n\t\t\t\t\t[encode(key, options), '[]=', encode(value, options)].join(''),\n\t\t\t\t];\n\t\t\t};\n\t\t}\n\n\t\tcase 'colon-list-separator': {\n\t\t\treturn key => (result, value) => {\n\t\t\t\tif (\n\t\t\t\t\tvalue === undefined\n\t\t\t\t\t|| (options.skipNull && value === null)\n\t\t\t\t\t|| (options.skipEmptyString && value === '')\n\t\t\t\t) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\treturn [\n\t\t\t\t\t\t...result,\n\t\t\t\t\t\t[encode(key, options), ':list='].join(''),\n\t\t\t\t\t];\n\t\t\t\t}\n\n\t\t\t\treturn [\n\t\t\t\t\t...result,\n\t\t\t\t\t[encode(key, options), ':list=', encode(value, options)].join(''),\n\t\t\t\t];\n\t\t\t};\n\t\t}\n\n\t\tcase 'comma':\n\t\tcase 'separator':\n\t\tcase 'bracket-separator': {\n\t\t\tconst keyValueSep = options.arrayFormat === 'bracket-separator'\n\t\t\t\t? '[]='\n\t\t\t\t: '=';\n\n\t\t\treturn key => (result, value) => {\n\t\t\t\tif (\n\t\t\t\t\tvalue === undefined\n\t\t\t\t\t|| (options.skipNull && value === null)\n\t\t\t\t\t|| (options.skipEmptyString && value === '')\n\t\t\t\t) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\t// Translate null to an empty string so that it doesn't serialize as 'null'\n\t\t\t\tvalue = value === null ? '' : value;\n\n\t\t\t\tif (result.length === 0) {\n\t\t\t\t\treturn [[encode(key, options), keyValueSep, encode(value, options)].join('')];\n\t\t\t\t}\n\n\t\t\t\treturn [[result, encode(value, options)].join(options.arrayFormatSeparator)];\n\t\t\t};\n\t\t}\n\n\t\tdefault: {\n\t\t\treturn key => (result, value) => {\n\t\t\t\tif (\n\t\t\t\t\tvalue === undefined\n\t\t\t\t\t|| (options.skipNull && value === null)\n\t\t\t\t\t|| (options.skipEmptyString && value === '')\n\t\t\t\t) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\treturn [\n\t\t\t\t\t\t...result,\n\t\t\t\t\t\tencode(key, options),\n\t\t\t\t\t];\n\t\t\t\t}\n\n\t\t\t\treturn [\n\t\t\t\t\t...result,\n\t\t\t\t\t[encode(key, options), '=', encode(value, options)].join(''),\n\t\t\t\t];\n\t\t\t};\n\t\t}\n\t}\n}\n\nfunction parserForArrayFormat(options) {\n\tlet result;\n\n\tswitch (options.arrayFormat) {\n\t\tcase 'index': {\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tresult = /\\[(\\d*)]$/.exec(key);\n\n\t\t\t\tkey = key.replace(/\\[\\d*]$/, '');\n\n\t\t\t\tif (!result) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = {};\n\t\t\t\t}\n\n\t\t\t\taccumulator[key][result[1]] = value;\n\t\t\t};\n\t\t}\n\n\t\tcase 'bracket': {\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tresult = /(\\[])$/.exec(key);\n\t\t\t\tkey = key.replace(/\\[]$/, '');\n\n\t\t\t\tif (!result) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = [value];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taccumulator[key] = [...accumulator[key], value];\n\t\t\t};\n\t\t}\n\n\t\tcase 'colon-list-separator': {\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tresult = /(:list)$/.exec(key);\n\t\t\t\tkey = key.replace(/:list$/, '');\n\n\t\t\t\tif (!result) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = [value];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taccumulator[key] = [...accumulator[key], value];\n\t\t\t};\n\t\t}\n\n\t\tcase 'comma':\n\t\tcase 'separator': {\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tconst isArray = typeof value === 'string' && value.includes(options.arrayFormatSeparator);\n\t\t\t\tconst isEncodedArray = (typeof value === 'string' && !isArray && decode(value, options).includes(options.arrayFormatSeparator));\n\t\t\t\tvalue = isEncodedArray ? decode(value, options) : value;\n\t\t\t\tconst newValue = isArray || isEncodedArray ? value.split(options.arrayFormatSeparator).map(item => decode(item, options)) : (value === null ? value : decode(value, options));\n\t\t\t\taccumulator[key] = newValue;\n\t\t\t};\n\t\t}\n\n\t\tcase 'bracket-separator': {\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tconst isArray = /(\\[])$/.test(key);\n\t\t\t\tkey = key.replace(/\\[]$/, '');\n\n\t\t\t\tif (!isArray) {\n\t\t\t\t\taccumulator[key] = value ? decode(value, options) : value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst arrayValue = value === null\n\t\t\t\t\t? []\n\t\t\t\t\t: value.split(options.arrayFormatSeparator).map(item => decode(item, options));\n\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = arrayValue;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taccumulator[key] = [...accumulator[key], ...arrayValue];\n\t\t\t};\n\t\t}\n\n\t\tdefault: {\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taccumulator[key] = [...[accumulator[key]].flat(), value];\n\t\t\t};\n\t\t}\n\t}\n}\n\nfunction validateArrayFormatSeparator(value) {\n\tif (typeof value !== 'string' || value.length !== 1) {\n\t\tthrow new TypeError('arrayFormatSeparator must be single character string');\n\t}\n}\n\nfunction encode(value, options) {\n\tif (options.encode) {\n\t\treturn options.strict ? strictUriEncode(value) : encodeURIComponent(value);\n\t}\n\n\treturn value;\n}\n\nfunction decode(value, options) {\n\tif (options.decode) {\n\t\treturn decodeComponent(value);\n\t}\n\n\treturn value;\n}\n\nfunction keysSorter(input) {\n\tif (Array.isArray(input)) {\n\t\treturn input.sort();\n\t}\n\n\tif (typeof input === 'object') {\n\t\treturn keysSorter(Object.keys(input))\n\t\t\t.sort((a, b) => Number(a) - Number(b))\n\t\t\t.map(key => input[key]);\n\t}\n\n\treturn input;\n}\n\nfunction removeHash(input) {\n\tconst hashStart = input.indexOf('#');\n\tif (hashStart !== -1) {\n\t\tinput = input.slice(0, hashStart);\n\t}\n\n\treturn input;\n}\n\nfunction getHash(url) {\n\tlet hash = '';\n\tconst hashStart = url.indexOf('#');\n\tif (hashStart !== -1) {\n\t\thash = url.slice(hashStart);\n\t}\n\n\treturn hash;\n}\n\nfunction parseValue(value, options) {\n\tif (options.parseNumbers && !Number.isNaN(Number(value)) && (typeof value === 'string' && value.trim() !== '')) {\n\t\tvalue = Number(value);\n\t} else if (options.parseBooleans && value !== null && (value.toLowerCase() === 'true' || value.toLowerCase() === 'false')) {\n\t\tvalue = value.toLowerCase() === 'true';\n\t}\n\n\treturn value;\n}\n\nexport function extract(input) {\n\tinput = removeHash(input);\n\tconst queryStart = input.indexOf('?');\n\tif (queryStart === -1) {\n\t\treturn '';\n\t}\n\n\treturn input.slice(queryStart + 1);\n}\n\nexport function parse(query, options) {\n\toptions = {\n\t\tdecode: true,\n\t\tsort: true,\n\t\tarrayFormat: 'none',\n\t\tarrayFormatSeparator: ',',\n\t\tparseNumbers: false,\n\t\tparseBooleans: false,\n\t\t...options,\n\t};\n\n\tvalidateArrayFormatSeparator(options.arrayFormatSeparator);\n\n\tconst formatter = parserForArrayFormat(options);\n\n\t// Create an object with no prototype\n\tconst returnValue = Object.create(null);\n\n\tif (typeof query !== 'string') {\n\t\treturn returnValue;\n\t}\n\n\tquery = query.trim().replace(/^[?#&]/, '');\n\n\tif (!query) {\n\t\treturn returnValue;\n\t}\n\n\tfor (const parameter of query.split('&')) {\n\t\tif (parameter === '') {\n\t\t\tcontinue;\n\t\t}\n\n\t\tconst parameter_ = options.decode ? parameter.replace(/\\+/g, ' ') : parameter;\n\n\t\tlet [key, value] = splitOnFirst(parameter_, '=');\n\n\t\tif (key === undefined) {\n\t\t\tkey = parameter_;\n\t\t}\n\n\t\t// Missing `=` should be `null`:\n\t\t// http://w3.org/TR/2012/WD-url-20120524/#collect-url-parameters\n\t\tvalue = value === undefined ? null : (['comma', 'separator', 'bracket-separator'].includes(options.arrayFormat) ? value : decode(value, options));\n\t\tformatter(decode(key, options), value, returnValue);\n\t}\n\n\tfor (const [key, value] of Object.entries(returnValue)) {\n\t\tif (typeof value === 'object' && value !== null) {\n\t\t\tfor (const [key2, value2] of Object.entries(value)) {\n\t\t\t\tvalue[key2] = parseValue(value2, options);\n\t\t\t}\n\t\t} else {\n\t\t\treturnValue[key] = parseValue(value, options);\n\t\t}\n\t}\n\n\tif (options.sort === false) {\n\t\treturn returnValue;\n\t}\n\n\t// TODO: Remove the use of `reduce`.\n\t// eslint-disable-next-line unicorn/no-array-reduce\n\treturn (options.sort === true ? Object.keys(returnValue).sort() : Object.keys(returnValue).sort(options.sort)).reduce((result, key) => {\n\t\tconst value = returnValue[key];\n\t\tif (Boolean(value) && typeof value === 'object' && !Array.isArray(value)) {\n\t\t\t// Sort object keys, not values\n\t\t\tresult[key] = keysSorter(value);\n\t\t} else {\n\t\t\tresult[key] = value;\n\t\t}\n\n\t\treturn result;\n\t}, Object.create(null));\n}\n\nexport function stringify(object, options) {\n\tif (!object) {\n\t\treturn '';\n\t}\n\n\toptions = {encode: true,\n\t\tstrict: true,\n\t\tarrayFormat: 'none',\n\t\tarrayFormatSeparator: ',', ...options};\n\n\tvalidateArrayFormatSeparator(options.arrayFormatSeparator);\n\n\tconst shouldFilter = key => (\n\t\t(options.skipNull && isNullOrUndefined(object[key]))\n\t\t|| (options.skipEmptyString && object[key] === '')\n\t);\n\n\tconst formatter = encoderForArrayFormat(options);\n\n\tconst objectCopy = {};\n\n\tfor (const [key, value] of Object.entries(object)) {\n\t\tif (!shouldFilter(key)) {\n\t\t\tobjectCopy[key] = value;\n\t\t}\n\t}\n\n\tconst keys = Object.keys(objectCopy);\n\n\tif (options.sort !== false) {\n\t\tkeys.sort(options.sort);\n\t}\n\n\treturn keys.map(key => {\n\t\tconst value = object[key];\n\n\t\tif (value === undefined) {\n\t\t\treturn '';\n\t\t}\n\n\t\tif (value === null) {\n\t\t\treturn encode(key, options);\n\t\t}\n\n\t\tif (Array.isArray(value)) {\n\t\t\tif (value.length === 0 && options.arrayFormat === 'bracket-separator') {\n\t\t\t\treturn encode(key, options) + '[]';\n\t\t\t}\n\n\t\t\treturn value\n\t\t\t\t.reduce(formatter(key), [])\n\t\t\t\t.join('&');\n\t\t}\n\n\t\treturn encode(key, options) + '=' + encode(value, options);\n\t}).filter(x => x.length > 0).join('&');\n}\n\nexport function parseUrl(url, options) {\n\toptions = {\n\t\tdecode: true,\n\t\t...options,\n\t};\n\n\tlet [url_, hash] = splitOnFirst(url, '#');\n\n\tif (url_ === undefined) {\n\t\turl_ = url;\n\t}\n\n\treturn {\n\t\turl: url_?.split('?')?.[0] ?? '',\n\t\tquery: parse(extract(url), options),\n\t\t...(options && options.parseFragmentIdentifier && hash ? {fragmentIdentifier: decode(hash, options)} : {}),\n\t};\n}\n\nexport function stringifyUrl(object, options) {\n\toptions = {\n\t\tencode: true,\n\t\tstrict: true,\n\t\t[encodeFragmentIdentifier]: true,\n\t\t...options,\n\t};\n\n\tconst url = removeHash(object.url).split('?')[0] || '';\n\tconst queryFromUrl = extract(object.url);\n\n\tconst query = {\n\t\t...parse(queryFromUrl, {sort: false}),\n\t\t...object.query,\n\t};\n\n\tlet queryString = stringify(query, options);\n\tif (queryString) {\n\t\tqueryString = `?${queryString}`;\n\t}\n\n\tlet hash = getHash(object.url);\n\tif (object.fragmentIdentifier) {\n\t\tconst urlObjectForFragmentEncode = new URL(url);\n\t\turlObjectForFragmentEncode.hash = object.fragmentIdentifier;\n\t\thash = options[encodeFragmentIdentifier] ? urlObjectForFragmentEncode.hash : `#${object.fragmentIdentifier}`;\n\t}\n\n\treturn `${url}${queryString}${hash}`;\n}\n\nexport function pick(input, filter, options) {\n\toptions = {\n\t\tparseFragmentIdentifier: true,\n\t\t[encodeFragmentIdentifier]: false,\n\t\t...options,\n\t};\n\n\tconst {url, query, fragmentIdentifier} = parseUrl(input, options);\n\n\treturn stringifyUrl({\n\t\turl,\n\t\tquery: includeKeys(query, filter),\n\t\tfragmentIdentifier,\n\t}, options);\n}\n\nexport function exclude(input, filter, options) {\n\tconst exclusionFilter = Array.isArray(filter) ? key => !filter.includes(key) : (key, value) => !filter(key, value);\n\n\treturn pick(input, exclusionFilter, options);\n}\n","import * as queryString from './base.js';\n\nexport default queryString;\n","function e(e){this.message=e}e.prototype=new Error,e.prototype.name=\"InvalidCharacterError\";var r=\"undefined\"!=typeof window&&window.atob&&window.atob.bind(window)||function(r){var t=String(r).replace(/=+$/,\"\");if(t.length%4==1)throw new e(\"'atob' failed: The string to be decoded is not correctly encoded.\");for(var n,o,a=0,i=0,c=\"\";o=t.charAt(i++);~o&&(n=a%4?64*n+o:o,a++%4)?c+=String.fromCharCode(255&n>>(-2*a&6)):0)o=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\".indexOf(o);return c};function t(e){var t=e.replace(/-/g,\"+\").replace(/_/g,\"/\");switch(t.length%4){case 0:break;case 2:t+=\"==\";break;case 3:t+=\"=\";break;default:throw\"Illegal base64url string!\"}try{return function(e){return decodeURIComponent(r(e).replace(/(.)/g,(function(e,r){var t=r.charCodeAt(0).toString(16).toUpperCase();return t.length<2&&(t=\"0\"+t),\"%\"+t})))}(t)}catch(e){return r(t)}}function n(e){this.message=e}function o(e,r){if(\"string\"!=typeof e)throw new n(\"Invalid token specified\");var o=!0===(r=r||{}).header?0:1;try{return JSON.parse(t(e.split(\".\")[o]))}catch(e){throw new n(\"Invalid token specified: \"+e.message)}}n.prototype=new Error,n.prototype.name=\"InvalidTokenError\";export default o;export{n as InvalidTokenError};\n//# sourceMappingURL=jwt-decode.esm.js.map\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport jwt_decode from \"jwt-decode\";\n\nexport const REFRESH_TIMING_BUFFER_MS = 5000 // refresh guest token early to avoid failed superset requests\nexport const MIN_REFRESH_WAIT_MS = 10000 // avoid blasting requests as fast as the cpu can handle\nexport const DEFAULT_TOKEN_EXP_MS = 300000 // (5 min) used only when parsing guest token exp fails\n\n// when do we refresh the guest token?\nexport function getGuestTokenRefreshTiming(currentGuestToken: string) {\n  const parsedJwt = jwt_decode<Record<string, any>>(currentGuestToken);\n  // if exp is int, it is in seconds, but Date() takes milliseconds\n  const exp = new Date(/[^0-9\\.]/g.test(parsedJwt.exp) ? parsedJwt.exp : parseFloat(parsedJwt.exp) * 1000);\n  const isValidDate = exp.toString() !== 'Invalid Date';\n  const ttl = isValidDate ? Math.max(MIN_REFRESH_WAIT_MS, exp.getTime() - Date.now()) : DEFAULT_TOKEN_EXP_MS;\n  return ttl - REFRESH_TIMING_BUFFER_MS;\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport {\n  DASHBOARD_UI_FILTER_CONFIG_URL_PARAM_KEY,\n  IFRAME_COMMS_MESSAGE_TYPE,\n} from \"./const\";\n\nimport queryString from \"query-string\";\n\n// We can swap this out for the actual switchboard package once it gets published\nimport { Switchboard } from \"@superset-ui/switchboard\";\nimport { getGuestTokenRefreshTiming } from \"./guestTokenRefresh\";\n\n/**\n * The function to fetch a guest token from your Host App's backend server.\n * The Host App backend must supply an API endpoint\n * which returns a guest token with appropriate resource access.\n */\nexport type GuestTokenFetchFn = () => Promise<string>;\n\nexport type UiConfigType = {\n  hideTitle?: boolean;\n  hideTab?: boolean;\n  hideChartControls?: boolean;\n  filters?: {\n    [key: string]: boolean | undefined;\n    visible?: boolean;\n    expanded?: boolean;\n  };\n  params?: Record<string, string | number | boolean>;\n};\n\nexport type EmbedDashboardParams = {\n  /** The id provided by the embed configuration UI in Superset */\n  id: string;\n  /** The domain where Superset can be located, with protocol, such as: https://superset.example.com */\n  supersetDomain: string;\n  /** The html element within which to mount the iframe */\n  mountPoint: HTMLElement;\n  /** A function to fetch a guest token from the Host App's backend server */\n  fetchGuestToken: GuestTokenFetchFn;\n  /** The dashboard UI config: hideTitle, hideTab, hideChartControls, filters.visible, filters.expanded **/\n  dashboardUiConfig?: UiConfigType;\n  /** Are we in debug mode? */\n  debug?: boolean;\n};\n\nexport type Size = {\n  width: number;\n  height: number;\n};\n\nexport type EmbeddedDashboard = {\n  getScrollSize: () => Promise<Size>;\n  unmount: () => void;\n  getDashboardPermalink: (anchor: string) => Promise<string>;\n  getActiveTabs: () => Promise<string[]>;\n};\n\n/**\n * Embeds a Superset dashboard into the page using an iframe.\n */\nexport async function embedDashboard({\n  id,\n  supersetDomain,\n  mountPoint,\n  fetchGuestToken,\n  dashboardUiConfig,\n  debug = false,\n}: EmbedDashboardParams): Promise<EmbeddedDashboard> {\n  // Validate params\n  if (!id || typeof id !== \"string\") {\n    throw new Error(\"Invalid id\");\n  }\n  if (!supersetDomain || typeof supersetDomain !== \"string\") {\n    throw new Error(\"Invalid supersetDomain\");\n  }\n  if (!mountPoint || !(mountPoint instanceof HTMLElement)) {\n    throw new Error(\"Invalid mountPoint\");\n  }\n  if (!fetchGuestToken || typeof fetchGuestToken !== \"function\") {\n    throw new Error(\"Invalid fetchGuestToken\");\n  }\n  function log(...info: unknown[]) {\n    if (debug) {\n      console.debug(`[superset-embedded-sdk][dashboard ${id}]`, ...info);\n    }\n  }\n\n  log(\"embedding\");\n\n  function calculateConfig() {\n    let configNumber = 0;\n    if (dashboardUiConfig) {\n      if (dashboardUiConfig.hideTitle) {\n        configNumber += 1;\n      }\n      if (dashboardUiConfig.hideTab) {\n        configNumber += 2;\n      }\n      if (dashboardUiConfig.hideChartControls) {\n        configNumber += 8;\n      }\n    }\n    return configNumber;\n  }\n\n  function checkFiterUrlParams(\n    filterConfig?: Record<string, any>\n  ): Record<string, string> {\n    if (!filterConfig || filterConfig.keys.length === 0) {\n      return {};\n    }\n    Object.keys(filterConfig).forEach((key) => {\n      if (!DASHBOARD_UI_FILTER_CONFIG_URL_PARAM_KEY.hasOwnProperty(key)) {\n        log(`Filter key '${key}' not allowed in filterConfig`);\n      }\n    });\n    return filterConfig;\n  }\n\n  async function mountIframe(): Promise<Switchboard> {\n    return new Promise((resolve) => {\n      const iframe = document.createElement(\"iframe\");\n      const dashboardConfig = dashboardUiConfig\n        ? `?uiConfig=${calculateConfig()}`\n        : \"\";\n      const filterConfig = checkFiterUrlParams(dashboardUiConfig?.filters);\n      const queryParams = dashboardUiConfig?.params || {};\n\n      const filterConfigUrlParams = queryString.stringify(\n        {\n          ...queryParams,\n          ...filterConfig,\n        },\n        { encode: false }\n      );\n\n      // set up the iframe's sandbox configuration\n      iframe.sandbox.add(\"allow-same-origin\"); // needed for postMessage to work\n      iframe.sandbox.add(\"allow-scripts\"); // obviously the iframe needs scripts\n      iframe.sandbox.add(\"allow-presentation\"); // for fullscreen charts\n      iframe.sandbox.add(\"allow-downloads\"); // for downloading charts as image\n      iframe.sandbox.add(\"allow-forms\"); // for forms to submit\n      iframe.sandbox.add(\"allow-popups\"); // for exporting charts as csv\n      // add these if it turns out we need them:\n      iframe.sandbox.add(\"allow-top-navigation\");\n\n      // add the event listener before setting src, to be 100% sure that we capture the load event\n      iframe.addEventListener(\"load\", () => {\n        // MessageChannel allows us to send and receive messages smoothly between our window and the iframe\n        // See https://developer.mozilla.org/en-US/docs/Web/API/Channel_Messaging_API\n        const commsChannel = new MessageChannel();\n        const ourPort = commsChannel.port1;\n        const theirPort = commsChannel.port2;\n\n        // Send one of the message channel ports to the iframe to initialize embedded comms\n        // See https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage\n        // we know the content window isn't null because we are in the load event handler.\n        iframe.contentWindow!.postMessage(\n          { type: IFRAME_COMMS_MESSAGE_TYPE, handshake: \"port transfer\" },\n          supersetDomain,\n          [theirPort]\n        );\n        log(\"sent message channel to the iframe\");\n\n        // return our port from the promise\n        resolve(\n          new Switchboard({\n            port: ourPort,\n            name: \"superset-embedded-sdk\",\n            debug,\n          })\n        );\n      });\n\n      iframe.src = `${supersetDomain}/embedded/${id}${dashboardConfig}${filterConfigUrlParams}`;\n      mountPoint.replaceChildren(iframe);\n      log(\"placed the iframe\");\n    });\n  }\n\n  const [guestToken, ourPort]: [string, Switchboard] = await Promise.all([\n    fetchGuestToken(),\n    mountIframe(),\n  ]);\n\n  ourPort.emit(\"guestToken\", { guestToken });\n  log(\"sent guest token\");\n\n  async function refreshGuestToken() {\n    const newGuestToken = await fetchGuestToken();\n    ourPort.emit(\"guestToken\", { guestToken: newGuestToken });\n    setTimeout(refreshGuestToken, getGuestTokenRefreshTiming(newGuestToken));\n  }\n\n  setTimeout(refreshGuestToken, getGuestTokenRefreshTiming(guestToken));\n\n  function unmount() {\n    log(\"unmounting\");\n    //@ts-ignore\n    mountPoint.replaceChildren();\n  }\n\n  const getScrollSize = () => ourPort.get<Size>(\"getScrollSize\");\n  const getDashboardPermalink = (anchor: string) =>\n    ourPort.get<string>(\"getDashboardPermalink\", { anchor });\n  const getActiveTabs = () => ourPort.get<string[]>(\"getActiveTabs\");\n\n  return {\n    getScrollSize,\n    unmount,\n    getDashboardPermalink,\n    getActiveTabs,\n  };\n}\n"],"names":["root","factory","exports","module","define","amd","globalThis","enterModule","reactHotLoaderGlobal","undefined","__signature__","default","signature","a","Actions","reactHotLoader","leaveModule","Switchboard","constructor","port","name","debug","this","methods","incrementor","debugMode","addEventListener","async","event","log","message","data","isGet","postMessage","getMethodResult","isEmit","method","args","executor","messageId","switchboardAction","ERROR","error","result","REPLY","err","logError","defineMethod","methodName","get","Promise","resolve","reject","getNewMessageId","listener","removeEventListener","isReply","errStr","isError","Error","start","GET","emit","EMIT","console","__reactstandin__regenerateByEval","key","code","eval","register","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","id","loaded","__webpack_modules__","d","definition","o","Object","defineProperty","enumerable","hmd","create","children","set","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","DASHBOARD_UI_FILTER_CONFIG_URL_PARAM_KEY","visible","expanded","token","singleMatcher","RegExp","multiMatcher","decodeComponents","components","split","decodeURIComponent","join","length","left","slice","right","Array","concat","decode","input","tokens","match","i","splitOnFirst","string","separator","TypeError","separatorIndex","indexOf","includeKeys","object","predicate","isArray","descriptor","getOwnPropertyDescriptor","Reflect","ownKeys","encodeFragmentIdentifier","validateArrayFormatSeparator","encode","options","strict","encodeURIComponent","replace","x","charCodeAt","toString","toUpperCase","encodedURI","replaceMap","exec","entries","keys","customDecodeURIComponent","keysSorter","sort","b","Number","map","removeHash","hashStart","parseValue","parseNumbers","isNaN","trim","parseBooleans","toLowerCase","extract","queryStart","parse","query","arrayFormat","arrayFormatSeparator","formatter","accumulator","includes","isEncodedArray","newValue","item","test","arrayValue","flat","parserForArrayFormat","returnValue","parameter","parameter_","key2","value2","reduce","Boolean","stringify","shouldFilter","skipNull","skipEmptyString","index","keyValueSep","encoderForArrayFormat","objectCopy","filter","parseUrl","url","url_","hash","parseFragmentIdentifier","fragmentIdentifier","stringifyUrl","queryString","getHash","urlObjectForFragmentEncode","URL","pick","exclude","e","window","atob","bind","t","String","n","c","charAt","fromCharCode","getGuestTokenRefreshTiming","currentGuestToken","parsedJwt","header","JSON","jwt_decode","exp","Date","parseFloat","Math","max","getTime","now","embedDashboard","supersetDomain","mountPoint","fetchGuestToken","dashboardUiConfig","HTMLElement","info","guestToken","ourPort","all","iframe","document","createElement","dashboardConfig","configNumber","hideTitle","hideTab","hideChartControls","calculateConfig","filterConfig","forEach","checkFiterUrlParams","filters","queryParams","params","filterConfigUrlParams","sandbox","add","commsChannel","MessageChannel","port1","theirPort","port2","contentWindow","type","handshake","src","replaceChildren","mountIframe","setTimeout","refreshGuestToken","newGuestToken","getScrollSize","unmount","getDashboardPermalink","anchor","getActiveTabs"],"sourceRoot":""}